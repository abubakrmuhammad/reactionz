var t=(t,e,r)=>new Promise(((s,i)=>{var n=t=>{try{o(r.next(t))}catch(e){i(e)}},a=t=>{try{o(r.throw(t))}catch(e){i(e)}},o=t=>t.done?s(t.value):Promise.resolve(t.value).then(n,a);o((r=r.apply(t,e)).next())}));!function(t=".",e="__import__"){try{self[e]=new Function("u","return import(u)")}catch(r){const s=new URL(t,location),i=t=>{URL.revokeObjectURL(t.src),t.remove()};self[e]=t=>new Promise(((r,n)=>{const a=new URL(t,s);if(self[e].moduleMap[a])return r(self[e].moduleMap[a]);const o=new Blob([`import * as m from '${a}';`,`${e}.moduleMap['${a}']=m;`],{type:"text/javascript"}),u=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(o),onerror(){n(new Error(`Failed to import: ${t}`)),i(u)},onload(){r(self[e].moduleMap[a]),i(u)}});document.head.appendChild(u)})),self[e].moduleMap={}}}("/assets/");const e={s:[1,200],a:[201,250],b:[251,350],c:[351,450],d:[451,550],e:[551,700],f:[700,864e5]};class r{constructor(){this.initialTime=0,this.currentTime=0}startTimer(){this.initialTime=(new Date).getTime(),this.currentTime=this.initialTime}stopTimer(){this.currentTime=(new Date).getTime()-this.initialTime}resetTimer(){this.initialTime=0,this.currentTime=0}getTime(){return this.currentTime}}class s{constructor(){this.timer=new r,this.results=[],this.totalTurns=5,this.currentTurnIndex=0}get averageResult(){const t=this.results.reduce(((t,e)=>t+e.time),0),e=parseInt((t/this.currentTurnIndex).toFixed(0));return{time:e,grade:this.findGrade(e)}}reset(){this.timer.resetTimer(),this.results.length=0,this.currentTurnIndex=0}recordResult(){this.timer.stopTimer();const t=this.timer.getTime(),e=this.findGrade(t);this.results.push({time:t,grade:e}),this.currentTurnIndex++}findGrade(t){return Object.keys(e).find((r=>{const[s,i]=e[r];return t>=s&&t<=i}))}}class i{constructor(){this.startButton=document.querySelector("#startButton"),this.targetBox=document.querySelector("#targetBox"),this.resultTable=document.querySelector("#resultTable")}get isTargetReady(){var t;return null==(t=this.targetBox)?void 0:t.classList.contains("app__target--ready")}displayResults(t){const e=this.resultTable.querySelectorAll("tbody tr");t.forEach(((t,r)=>{const[,s,i]=e[r].children,{time:n,grade:a}=t;s.textContent=n+" ms",i.textContent=a,i.className="grade grade--"+a}))}displayAverageResult(t){const e=this.resultTable.querySelector("tfoot tr"),[,r,s]=e.children,{time:i,grade:n}=t;r.textContent=i+" ms",s.textContent=n,s.className="grade grade--"+n}reset(){this.targetBox.classList.remove("app__target--ready"),this.targetBox.textContent="";this.resultTable.querySelectorAll("tbody tr, tfoot tr").forEach((t=>{const[,e,r]=t.children;e.textContent="",r.textContent="",r.className="grade"}))}readyButton(){this.startButton.setAttribute("disabled",""),this.startButton.textContent="Test Started"}unreadyButton(){this.startButton.removeAttribute("disabled"),this.startButton.textContent="Start Test"}readyTarget(){this.targetBox.classList.add("app__target--ready"),this.targetBox.textContent="Click Now!"}unreadyTarget(){this.targetBox.classList.remove("app__target--ready"),this.targetBox.textContent="Wait for Green..."}doneTarget(){this.targetBox.classList.add("app__target--ready"),this.targetBox.textContent="Test Complete"}resizeTargetBox(t=4/3){var e;const r=(null==(e=this.targetBox)?void 0:e.clientWidth)/t;this.targetBox.style.setProperty("height",`${r}px`)}waitForTargetClick(){return t(this,null,(function*(){return new Promise((t=>{const e=()=>{t(),this.targetBox.removeEventListener("click",e)};this.targetBox.addEventListener("click",e)}))}))}targetCountdown(e=3){return t(this,null,(function*(){this.targetBox.classList.add("app__target--countdown");const t=[];let r=0;for(;e>=0;){const s=t=>{setTimeout((e=>{this.targetBox.textContent=e?e.toString():"",t()}),r,e)};t.push(new Promise(s)),r+=1e3,e--}yield Promise.all(t),this.targetBox.classList.remove("app__target--countdown")}))}}(new class{constructor(){this.ui=new i,this.state=new s,this.endTurn=this.endTurn.bind(this)}init(){this.ui.resizeTargetBox(),this.setupInitialEventListeners()}setupInitialEventListeners(){this.ui.startButton.addEventListener("click",(()=>this.startTest())),window.addEventListener("resize",(()=>this.ui.resizeTargetBox()))}startTest(){return t(this,null,(function*(){this.clearLastTest(),this.ui.readyButton(),yield this.ui.targetCountdown(3);do{yield this.doTurn()}while(this.state.currentTurnIndex<this.state.totalTurns);this.ui.unreadyButton(),this.ui.doneTarget()}))}clearLastTest(){this.ui.reset(),this.state.reset()}doTurn(){return t(this,null,(function*(){const t=Math.floor(4e3*Math.random()+1e3);yield this.startTurn(t),yield this.ui.waitForTargetClick(),this.ui.displayResults(this.state.results),this.ui.displayAverageResult(this.state.averageResult)}))}startTurn(e){return t(this,null,(function*(){return this.ui.unreadyTarget(),new Promise((t=>{setTimeout((()=>{this.ui.readyTarget(),this.ui.targetBox.addEventListener("click",this.endTurn),this.state.timer.startTimer(),t()}),e)}))}))}endTurn(){this.ui.unreadyTarget(),this.ui.targetBox.removeEventListener("click",this.endTurn),this.state.recordResult()}}).init();
